
:root {
  --panel-bg: rgba(255,255,255,.32);
  --panel-border: rgba(0,0,0,.04);
  --shadow: 0 10px 30px rgba(0,0,0,.05);
}
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  background: #f5f5f4;
  color: #111827;
}
.wrap { max-width: 1000px; margin: 16px auto; padding: 0 12px 56px; }
.toolbar {
  position: sticky; top: 0;
  background: rgba(255,255,255,.9);
  backdrop-filter: saturate(1.1) blur(6px);
  border-bottom: 1px solid #e5e7eb;
  display: flex; gap: 8px; align-items: center; padding: 10px 12px; z-index: 60;
}
.title { font-weight: 700; }
.btn {
  font-size: 14px; border: 1px solid #e5e7eb; border-radius: 12px;
  background: white; padding: 8px 10px; cursor: pointer;
}
.hint { margin-left: auto; font-size: 12px; color: #6b7280; }
.stage {
  position: relative; width: 100%; aspect-ratio: 1000 / 700;
  background: #ddd; border-radius: 16px; overflow: hidden; box-shadow: var(--shadow); margin-top: 14px;
}
.bg {
  position: absolute; inset: 0;
  background-position: center; background-size: cover;
  filter: saturate(.95) contrast(1.03);
}
.badge {
  position: absolute; top: 8px; right: 8px;
  padding: 4px 8px; font-size: 12px; border-radius: 10px;
  background: rgba(255,255,255,.95); border: 1px solid #e5e7eb;
  box-shadow: 0 4px 14px rgba(0,0,0,.06);
  z-index: 30;
}
.debug {
  position: absolute; bottom: 8px; right: 8px;
  padding: 4px 8px; font-size: 12px; border-radius: 10px;
  background: rgba(255,255,255,.95); border: 1px solid #e5e7eb;
  box-shadow: 0 4px 14px rgba(0,0,0,.06);
  z-index: 30; color: #374151;
}
.poem { position: absolute; left: 0; right: auto; bottom: 0; padding: 12px; z-index: 40; }
.panel {
  width: 100%;
  max-width: 1000px;
  line-height: 1.9;
  background: var(--panel-bg); backdrop-filter: blur(1.5px);
  border: 1px solid var(--panel-border);
  border-radius: 14px; padding: 16px 18px;
  box-shadow: 0 8px 20px rgba(0,0,0,.04);
  font-size: 16px;
}
@media (max-width: 680px) {
  .panel { width: 98%; }
}
.verse { display: block; white-space: pre-wrap; }
.token { display: inline; padding: 0 2px; border-radius: 6px; }
.token[data-s] { position: relative; }
.token[data-s]:hover { background: #fde68a; outline: 1px solid #ca8a04; cursor: pointer; }
.token.active { background: #fef3c7; outline: 1px solid #d97706; }
.legend { font-size: 12px; color: #374151; margin-top: 10px; }
.peg { position: fixed; z-index: 65; pointer-events: none; color: #1f2937; }
svg#overlay { position:absolute; inset:0; width:100%; height:100%; pointer-events:none; z-index:20; }
